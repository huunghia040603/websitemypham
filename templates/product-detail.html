{% extends "base.html" %}

{% block title %}Chi tiết sản phẩm - BuddySkincare{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header bg-light py-3" id="product-detail-page">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="/" class="text-decoration-none">Trang chủ</a></li>
                <li class="breadcrumb-item"><a href="/products" class="text-decoration-none">Sản phẩm</a></li>
                <li class="breadcrumb-item"><a href="#" class="text-decoration-none" id="detailCategory">Danh mục</a></li>
                <li class="breadcrumb-item active" aria-current="page" id="detailBreadcrumb">Đang tải...</li>
            </ol>
        </nav>
    </div>
</section>

<!-- Product Detail -->
<section class="product-detail py-5">
    <div class="container">
        <div class="row">
            <!-- Product Images -->
            <div class="col-lg-6">
                <div class="product-images">
                    <!-- Main Image -->
                    <div class="main-image mb-3">
                        <img src="/static/image/default-product.jpg" 
                             alt="Hình sản phẩm" 
                             class="img-fluid rounded" 
                             id="mainImage">
                    </div>
                    
                    <!-- Thumbnail Images -->
                    <div class="thumbnail-images d-flex gap-2" id="thumbnailContainer"></div>
                </div>
            </div>
            
            <!-- Product Info -->
            <div class="col-lg-6">
                <div class="product-info">
                    <h1 class="fw-bold mb-2" id="detailName">Đang tải...</h1>
                    <p class="text-muted mb-3" id="detailBrand"></p>
                    
                    <!-- Rating -->
                    <div class="d-flex align-items-center mb-3">
                        <div class="stars text-warning me-2" id="detailStars"></div>
                        <span class="text-muted me-2" id="detailReviews">(0 đánh giá)</span>
                        <span class="text-success" id="detailStock"></span>
                    </div>
                    
                    <!-- Price -->
                    <div class="price-section mb-4">
                        <div class="d-flex align-items-center">
                            <span class="text-decoration-line-through text-muted fs-5 me-3" id="detailOriginalPrice"></span>
                            <span class="text-danger fw-bold fs-2" id="detailDiscountedPrice"></span>
                            <span class="badge bg-danger ms-2 fs-6" id="detailDiscountBadge" style="display:none"></span>
                        </div>
                        <small class="text-muted" id="detailSavings"></small>
                    </div>
                    
                    <!-- Product Status -->
                    <div class="product-status mb-4" id="detailStatus" style="display:none">
                        <div class="alert alert-warning d-flex align-items-center">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <div id="detailStatusText"></div>
                        </div>
                    </div>
                    
                    <!-- Quantity -->
                    <div class="quantity-section mb-4">
                        <label class="form-label fw-semibold">Số lượng:</label>
                        <div class="d-flex align-items-center">
                            <button class="btn btn-outline-secondary" onclick="changeQuantity(-1)">-</button>
                            <input type="number" class="form-control mx-2" value="1" min="1" id="quantity" style="width: 80px;">
                            <button class="btn btn-outline-secondary" onclick="changeQuantity(1)">+</button>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="action-buttons mb-4">
                        <div class="row g-2">
                            <div class="col-8">
                                <button class="btn btn-primary btn-lg w-100" id="detailAddToCartBtn">
                                    <i class="fas fa-shopping-cart me-2"></i>Thêm vào giỏ hàng
                                </button>
                            </div>
                            <div class="col-4">
                                <button class="btn btn-outline-primary btn-lg w-100" id="detailBuyNowBtn">
                                    Mua ngay
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Wishlist -->
                    <div class="wishlist-section mb-4">
                        <button class="btn btn-outline-secondary w-100">
                            <i class="far fa-heart me-2"></i>Thêm vào yêu thích
                        </button>
                    </div>
                    
                    <!-- Product Features -->
                    <div class="product-features mb-4">
                        <h6 class="fw-semibold mb-3">Đặc điểm nổi bật:</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Chính hãng Mac Cosmetics</li>
                            <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Màu sắc bền lâu</li>
                            <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Không khô môi</li>
                            <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Phù hợp mọi tông da</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Product Details Tabs -->
<section class="product-tabs py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <!-- Tab Navigation -->
                <ul class="nav nav-tabs" id="productTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab">
                            Mô tả
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="specifications-tab" data-bs-toggle="tab" data-bs-target="#specifications" type="button" role="tab">
                            Thông số
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">
                            Đánh giá
                        </button>
                    </li>
                </ul>
                
                <!-- Tab Content -->
                <div class="tab-content" id="productTabsContent">
                    <!-- Description Tab -->
                    <div class="tab-pane fade show active" id="description" role="tabpanel">
                        <div class="p-4" id="detailDescription">Đang cập nhật mô tả sản phẩm...</div>
                    </div>
                    
                    <!-- Specifications Tab -->
                    <div class="tab-pane fade" id="specifications" role="tabpanel">
                        <div class="p-4" id="detailSpecifications">Đang cập nhật thông số...</div>
                    </div>
                    
                    <!-- Reviews Tab -->
                    <div class="tab-pane fade" id="reviews" role="tabpanel">
                        <div class="p-4" id="detailReviewsTab">Chưa có đánh giá.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Related Products -->
<section class="related-products py-5">
    <div class="container">
        <h3 class="fw-bold text-center mb-4">Sản phẩm liên quan</h3>
        <div id="related-products-container">
            <div class="text-center py-4">
                <div class="spinner-border text-primary" role="status"><span class="visually-hidden">Đang tải...</span></div>
                <p class="text-muted mt-2">Đang tải sản phẩm liên quan...</p>
            </div>
        </div>
    </div>
</section>

<!-- Review Modal -->
<div class="modal fade" id="reviewModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Viết đánh giá</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Đánh giá của bạn:</label>
                        <div class="stars-input">
                            <i class="far fa-star" data-rating="1"></i>
                            <i class="far fa-star" data-rating="2"></i>
                            <i class="far fa-star" data-rating="3"></i>
                            <i class="far fa-star" data-rating="4"></i>
                            <i class="far fa-star" data-rating="5"></i>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Tiêu đề:</label>
                        <input type="text" class="form-control" placeholder="Tóm tắt đánh giá của bạn">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nội dung:</label>
                        <textarea class="form-control" rows="4" placeholder="Chia sẻ trải nghiệm của bạn về sản phẩm"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Hình ảnh (tùy chọn):</label>
                        <input type="file" class="form-control" multiple accept="image/*">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-primary">Gửi đánh giá</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Keep helper functions
function changeMainImage(src) { document.getElementById('mainImage').src = src; }
function changeQuantity(delta) {
    const quantityInput = document.getElementById('quantity');
    let currentValue = parseInt(quantityInput.value) || 1;
    let newValue = currentValue + delta;
    if (newValue >= 1) { quantityInput.value = newValue; }
}

// Add to cart
function addToCart() {
    const quantity = document.getElementById('quantity').value;
    // Simulate adding to cart
    alert(`Đã thêm ${quantity} sản phẩm vào giỏ hàng!`);
}

// Buy now
function buyNow() {
    const quantity = document.getElementById('quantity').value;
    // Redirect to checkout
    alert(`Chuyển đến trang thanh toán với ${quantity} sản phẩm!`);
}

// Star rating for review modal
document.addEventListener('DOMContentLoaded', function() {
    const stars = document.querySelectorAll('.stars-input i');
    stars.forEach(star => {
        star.addEventListener('click', function() {
            const rating = this.dataset.rating;
            stars.forEach((s, index) => {
                if (index < rating) {
                    s.classList.remove('far');
                    s.classList.add('fas');
                } else {
                    s.classList.remove('fas');
                    s.classList.add('far');
                }
            });
        });
    });
});
</script>
{% endblock %} 